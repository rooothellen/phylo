---
title: "Tutorial 2: Introduction to Phylogenies"
output: html_document
date: "2026-01-20"
---

Make sure the R session is running in the same directory as the script file. (check "Tutorial_0_about_RStudio.R")

## Working with phylogenies in R

In this class we will need to visualize, print, modify and generate phylogenetic trees. We will use R to do all these things. Here we will go over the basics of working with phylogenies in R.

Load the 'ape' package:

```{r}
library( ape ) # If you got an error message or don't know about this: go back to "Tutorial_1_syntax.R"
```

Phylogenetic relationships among taxa can be described by indicating each monophyletic clade. If we enumerate every monophyletic clade in a phylogeny, then we have all the information to draw the tree. One way to do this is to describe monophyletic clades using parentheses. 

See the example below:

```{r}
newick_phy <- "((((human, mouse), lizard), frog), fish);"
```

Compare the parentheses and commas above with the figure in the previous reading "The Tree-Thinking Challenge". Can you recognize the relationships in the figure with the pattern above?

Here each matching parentheses represent a monophyletic clade and each of these has a correspondent node in the phylogenetic tree.

Note that RStudio will highlight the matching parenthesis if you place the cursor next to a parenthesis. (This is a super useful thing!!!)

This particular format to represent a tree is known as the "Newick format".

Go check wikipedia: (Newick format)[https://en.wikipedia.org/wiki/Newick_format]

We can read a tree from the Newick format using the function `read.tree`

```{r}
phy <- read.tree(text = newick_phy)
```

This function will read the information about species relationships from the Newick format and create a phylogenetic tree object of class "phylo". Let's check how the object looks like:

```{r}
phy
```


Printing the `phy` object will give some important information about the phylogeny. We see that there are 5 tips and 4 internal nodes. We can also see a list of the 'Tip labels' (These are the names of the tips.)

Note that this phylogeny is 'Rooted' and has no information for branch lengths. We will explore these elements later.

Finally, let's make a pretty figure of our phylogeny!

```{r}
plot.phylo( phy )
```

**Question 5**: How this phylogeny compares to the original tree in Baum et al. (2005) paper?

## Writing and reading trees

We just plotted our first tree! Nice!

Make sure to check the help page for the functions we used. These are important ones.

```{r}
help( read.tree )
```

**Question 6**:  Do you see other ways to use this function?

```{r}
help( plot.phylo ) 
```

See all the extra arguments we can use to adjust the plot? Modify one of the arguments and replot the tree. 

```{r}
plot.phylo(x = phy, 
           edge.color = "blue", #make the edges of the tree blue
           font = 2, # change the font from italic to bold
           direction = "upwards",
            # change the orientation of the tree to face upwards
)
```

**Question 7**: What was the function call you used?

We can write the phylogenetic tree to a file. There are two most commonly used file formats for trees. One is the 'Newick' (as we saw before) and the other is the 'Nexus" format.

The 'Newick' file format is a simple text file with the tree. We can use the function `write.tree`:

```{r}
write.tree(phy = phy, file = "Baum_2005_phylo.tre")
```

Open the file "Baum_2005_phylo.tre" in a text editor and check the Newick line.

NOTE: Don't know where the file is? Check "Tutorial_0_about_RStudio.pdf".

The 'Nexus' file format is similar, but stores some additional information:

```{r}
write.nexus(phy, file = "Baum_2005_phylo.nex")
```


Open the file "Baum_2005_phylo.nex" in a text editor. Can you understand the information in this file?

Check the help page for the functions 'write.tree' and 'write.nexus'.

Now we can read the tree from the files back to R. For this we use the functions 'read.tree' and 'read.nexus'.

```{r}
phy_from_newick <- read.tree(file = "Baum_2005_phylo.tre")
phy_from_nexus <- read.nexus(file = "Baum_2005_phylo.nex")
```

Plot each tree object. Check if they are the same.

```{r}
plot(phy_from_newick)
```

```{r}
plot(phy_from_nexus)
```


